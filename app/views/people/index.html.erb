<% content_for :title do %>
  <li><%= link_to 'People', people_path %></li>
<% end %>

<p data-has-preferences="<%= @has_preferences %>" id="new-people-message"<%= raw ' style="display: none"' if @people.count < 1 || @has_preferences %>>
  Now, click your name below and rate some candy!
</p>

<ul class="people-list">
  <% @people.each do |person| %>
    <li>
      <ul class="person-preferences">
        <% type_index = 0 %>
        <% person.preferences_summary.each do |type, candies| %>
          <li class="preference-<%= type %> preference-<%= type_index %>">
            <% if type_index == 0 %>
              <%= link_to person, person_preferences_path(person) %>
            <% else %>
              &mdash;
            <% end %>
            <%= type %>
            <% candies.each_with_index do |candy, i| %>
              <strong><%= candy %></strong><% if i == candies.length - 2 %><% if candies.length > 2 %>,<% end %> and<% elsif i < candies.length - 1 %>, <% end %><% if i == candies.length - 1 %>.<% end %>
            <% end %>
          </li>
          <% type_index += 1 %>
        <% end %>
      </ul>
    </li>
  <% end %>
</ul>

<hr id="people-divider" <%= raw ' style="display: none"' if @people.count < 1 %>>

<p id="add-people-instructions"<%= raw ' style="display: none"' if @people.count > 0 %>>
  Who do you want to share candy with? Add them below! Be sure to add yourself.
</p>

<p id="person-error" class="alert deep-orange lighten-3" style="display: none"></p>

<div class="row">
  <form class="add-person col s12">
    <div class="row">
      <div class="input-field col s6">
        <i class="material-icons prefix">add</i>
        <input type="text" id="new-person-name" placeholder="Name">
        <label for="new-person-name">Add person</label>
      </div>
    </div>
  </form>
</div>
